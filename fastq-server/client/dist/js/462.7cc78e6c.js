"use strict";(self["webpackChunkfastq_client"]=self["webpackChunkfastq_client"]||[]).push([[462],{3489:function(t,e,s){s.r(e),s.d(e,{default:function(){return Z}});var a=s(998),i=s(6190),r=s(4145),o=s(4886),n=s(266),c=s(4324),l=s(4528),d=s(9481),h=s(7808),u=s(6313),m=function(){var t=this,e=t._self._c;return e(a.Z,[e("div",{staticClass:"container-fluid h-100"},[e("div",{staticClass:"row h-100"},[e("div",{staticClass:"col-md-3 h-80"},[e(r.Z,{staticClass:"h-100",attrs:{flat:""}},[e(o.EB,{attrs:{"primary-title":""}},[t._v(" "+t._s(t.$store.state.Auth.activeCounter.CounterName)+" ")]),e("hr"),e("div",{staticClass:"d-flex p-2"},[e(r.Z,{staticClass:"w-100",attrs:{elevation:"6"}},[e("h4",{staticClass:"p-1"},[t._v("CURRENT:")]),e("h1",{staticClass:"font-weight-bold px-2"},[t._v(t._s(t.$store.state.Auth.activeTicket.TicketName))])])],1),e("hr"),e("div",{staticClass:"d-flex p-2"},[e(r.Z,{staticClass:"w-100",attrs:{flat:""}},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-12 d-flex justify-content-between"},[e("p",{staticClass:"px-2"},[t._v("Processing Time :")]),e("div",{staticClass:"px-2"},[e("Stopwatch",{attrs:{resetWhenStart:!0,running:t.startTimer,starter:t.calculateTimestampDifference(t.$store.state.Auth.activeTicket.StartedServingAt,t.convertDateToCustomFormat(t.convertDateToIndianTimestampFormat(new Date)))}})],1)]),e("div",{staticClass:"col-md-12 d-flex justify-content-between"},[e("p",{staticClass:"px-2"},[t._v("Waiting Time :")]),e("div",{staticClass:"px-2"},[e("Stopwatch",{attrs:{resetWhenStart:!0,running:t.startTimer,starter:t.calculateTimestampDifference(t.$store.state.Auth.activeTicket.CreatedAt,t.convertDateToCustomFormat(t.convertDateToIndianTimestampFormat(new Date)))}})],1)]),e("div",{staticClass:"col-md-12 d-flex justify-content-between"},[e("p",{staticClass:"px-2"},[t._v("Transaction :")]),e("div",{staticClass:"px-2"},[e("Stopwatch",{attrs:{resetWhenStart:!0,running:t.startTimer,starter:t.calculateTimestampDifference(t.$store.state.Auth.activeTicket.StartedServingAt,t.convertDateToCustomFormat(t.convertDateToIndianTimestampFormat(new Date)))+t.calculateTimestampDifference(t.$store.state.Auth.activeTicket.CreatedAt,t.convertDateToCustomFormat(t.convertDateToIndianTimestampFormat(new Date)))}})],1)])])])],1),e("hr"),e("div",{staticClass:"d-flex p-2"},[e(r.Z,{staticClass:"w-100",attrs:{elevation:"6"}},[e("h4",{staticClass:"p-2"},[t._v("LAST CALLED :")]),"NO_RESULT"!==t.lastcalled?e("div",{staticClass:"d-flex justify-content-around"},[e("div",{staticClass:"d-flex flex-column"},[e("h1",{staticClass:"font-weight-bold"},[t._v(t._s(t.lastcalled.TicketName))]),e("h6",{staticClass:"font-weight-bold"},[t._v(t._s(t.lastcalled.Service))])]),e("div",{staticClass:"d-flex flex-column"},[e("h1",{staticClass:"font-weight-bold"},[t._v("1")]),e("h6",{staticClass:"font-weight-bold"},[t._v(t._s(t.$store.state.Auth.activeCounter.CounterName))])])]):t._e()])],1),e("hr")],1)],1),e("div",{staticClass:"col-md-9 h-80"},[e(r.Z,{staticClass:"h-100",attrs:{flat:""}},[e("div",{staticClass:"d-flex row p-2"},[e("div",{staticClass:"col-md-4"},[e(d.Z,{attrs:{items:t.users,"item-text":"name","item-value":"","return-object":"",label:"Transfer To",solo:"",dense:""},model:{value:t.user,callback:function(e){t.user=e},expression:"user"}})],1)]),e("div",{staticClass:"container mt-2"},[e("div",{staticClass:"row text-white justify-content-between"},[e(r.Z,{staticClass:"col-md-2 pink accent-2 d-flex flex-column align-items-center text-white main-card",class:{disabled:t.disableNext},attrs:{hover:"",ripple:""},on:{click:function(e){return e.preventDefault(),t.getnextticket.apply(null,arguments)}}},[e(c.Z,{attrs:{size:"48px",color:"white"}},[t._v(" mdi-arrow-right-bold-circle ")]),e("h6",[t._v("Call Next")])],1),e(r.Z,{staticClass:"col-md-2 primary d-flex flex-column align-items-center text-white",attrs:{hover:"",ripple:""}},[e(c.Z,{attrs:{size:"48px",color:"white"}},[t._v(" mdi-volume-high ")]),e("h6",[t._v("Call Again")])],1),e(r.Z,{staticClass:"col-md-2 warning accent-2 d-flex flex-column align-items-center text-white",attrs:{hover:"",ripple:""}},[e(c.Z,{attrs:{size:"48px",color:"white"}},[t._v(" mdi-lock ")]),e("h6",[t._v("Standby")])],1),e(r.Z,{staticClass:"col-md-2 red accent-2 d-flex flex-column align-items-center text-white",attrs:{hover:"",ripple:""},on:{click:function(e){return e.preventDefault(),t.updateLastTicketStatus("NO_SHOW")}}},[e(c.Z,{attrs:{size:"48px",color:"white"}},[t._v(" mdi-close-octagon ")]),e("h6",[t._v("No Show")])],1),e(r.Z,{staticClass:"col-md-2 green accent-4 d-flex flex-column align-items-center text-white",attrs:{hover:"",ripple:""},on:{click:function(e){return e.preventDefault(),t.updateLastTicketStatus("FINISHED")}}},[e(c.Z,{attrs:{size:"48px",color:"white"}},[t._v(" mdi-check ")]),e("h6",[t._v("Finish")])],1)],1)]),e("div",{staticClass:"container mt-3 w-100"},[e("div",{staticClass:"row"},[e("div",{staticClass:"col-md-3"},[e("div",{staticClass:"d-flex flex-column"},[e("h5",[t._v("Done")]),e("h1",[t._v(t._s(t.finished.length))])])]),e("div",{staticClass:"col-md-9 d-flex flex-wrap gap-2 justify-center align-center"},[e(n.Z,{staticClass:"m-0 p-0",attrs:{cols:"12",sm:"12"}},[e("p",{staticClass:"grey--text text-center"},[t._v("Customer Information")])]),e(n.Z,{staticClass:"m-0 p-0",attrs:{cols:"12",sm:"4"}},[e(h.Z,{staticClass:"m-0 p-0",attrs:{label:"customer name","hide-details":"auto",placeholder:"",solo:"",dense:""}})],1),e(n.Z,{staticClass:"m-0 p-0",attrs:{cols:"12",sm:"4"}},[e(h.Z,{staticClass:"m-0 p-0",attrs:{label:"customer name",placeholder:"","hide-details":"auto",solo:"",dense:""}})],1),e(n.Z,{staticClass:"m-0 p-0",attrs:{cols:"12",sm:"4"}},[e(h.Z,{staticClass:"m-0 p-0",attrs:{label:"customer name","hide-details":"auto",placeholder:"",solo:"",dense:""}})],1),e(n.Z,{staticClass:"m-0 p-0",attrs:{cols:"12",sm:"4"}},[e(h.Z,{staticClass:"m-0 p-0",attrs:{label:"mo. number","hide-details":"auto",placeholder:"",solo:"",dense:""}})],1),e(n.Z,{staticClass:"m-0 p-0 text-center",attrs:{cols:"12",sm:"12"}},[e(i.Z,{staticStyle:{"margin-top":"2px"},attrs:{color:"primary text-white green accent-4"}},[e(c.Z,{attrs:{left:""}},[t._v(" mdi-content-save ")]),t._v(" save ")],1)],1)],1)])]),e("div",{staticClass:"col-md-12 d-flex justify-content-between h-50 mt-3"},[e(r.Z,{staticClass:"col-md-4 h-100",attrs:{flat:""}},[e("div",{staticClass:"row"},[e(u.Z,{staticClass:"mb-2",attrs:{color:"pink accent-2 darken-2"}},[e(o.EB,{staticClass:"text-white",attrs:{"primary-title":""}},[t._v(" WAITING: "+t._s(t.waiting.length)+" ")])],1),e("div",{staticClass:"p-3"},t._l(t.waiting,(function(s){return e(r.Z,{key:s.ID,staticClass:"d-flex p-2 align-items-center justify-content-between mb-2",attrs:{elevation:"5",outlined:"",shaped:""}},[e("div",[t._v(t._s(s.TicketName))]),e("Stopwatch",{attrs:{resetWhenStart:!0,running:!0,starter:t.calculateTimestampDifference(s.CreatedAt,t.convertDateToCustomFormat(t.convertDateToIndianTimestampFormat(new Date)))}}),e(l.Z,{attrs:{"open-on-hover":"","offset-y":"","close-on-content-click":!1,top:"","content-class":"bg-white p-3"},scopedSlots:t._u([{key:"activator",fn:function({on:s,attrs:a}){return[e(c.Z,t._g(t._b({},"v-icon",a,!1),s),[t._v(" mdi-information ")])]}}],null,!0)},[e("table",{staticClass:"text-caption bg-white",attrs:{width:"100%",cellpadding:"3"}},[e("tbody",{},[e("tr",[e("th",{attrs:{id:"titleHeader",colspan:"3"}},[t._v("Queue Details")])]),e("tr",{staticClass:"p-3"},[e("td",{attrs:{id:"label1",width:"30%"}},[t._v("Information")]),e("td",{attrs:{width:"5%"}},[t._v(":")]),e("td",{attrs:{id:"informationList",width:"65%",align:"right"}},[t._v("john")])]),e("tr",[e("td",{attrs:{id:"label1",width:"30%"}},[t._v("Mobile")]),e("td",{attrs:{width:"5%"}},[t._v(":")]),e("td",{attrs:{id:"mobileNumber",width:"65%",align:"right"}},[t._v("123456789")])]),e("tr",[e("td",{attrs:{id:"label1",width:"30%"}},[t._v("Email")]),e("td",{attrs:{width:"5%"}},[t._v(":")]),e("td",{attrs:{id:"email",width:"65%",align:"right"}},[t._v("h@mail.com")])]),e("tr",[e("td",{attrs:{id:"label1",width:"30%"}},[t._v("date")]),e("td",{attrs:{width:"5%"}},[t._v(":")]),e("td",{attrs:{id:"dateStr",width:"65%",align:"right"}},[t._v("June 25, 2023")])]),e("tr",[e("td",{attrs:{id:"label1",width:"30%"}},[t._v("Transaction")]),e("td",{attrs:{width:"5%"}},[t._v(":")]),e("td",{attrs:{id:"transactionName",width:"65%",align:"right"}},[t._v("Inquiry")])]),e("tr",[e("td",{attrs:{id:"label2",width:"30%"}},[t._v("Transaction Types")]),e("td",{attrs:{width:"5%"}},[t._v(":")]),e("td",{attrs:{width:"65%",id:"transactionTypesList",align:"right"}})])])])])],1)})),1)],1)]),e(r.Z,{staticClass:"col-md-4 h-100",attrs:{flat:""}},[e("div",{staticClass:"row"},[e(u.Z,{attrs:{color:"red accent-2"}},[e(o.EB,{staticClass:"text-white",attrs:{"primary-title":""}},[t._v(" NO SHOW : "+t._s(t.noShow.length)+" ")])],1),e("div",{staticClass:"p-3"},t._l(t.noShow,(function(s){return e(r.Z,{key:s.ID,staticClass:"mt-3 p-2 d-flex align-items-center justify-content-between",attrs:{elevation:"5",outlined:"",shaped:""}},[e("div",[t._v(t._s(s.TicketName))]),e("Stopwatch",{attrs:{resetWhenStart:!0,running:!1}})],1)})),1)],1)]),e(r.Z,{staticClass:"col-md-4 h-100",attrs:{flat:""}},[e("div",{staticClass:"row"},[e(u.Z,{attrs:{color:"green accent-4"}},[e(o.EB,{staticClass:"text-white"},[t._v(" TRANSACTIONS: "+t._s(t.finished.length)+" ")])],1),e("div",{staticClass:"p-3"},[t._l(t.finished,(function(s){return e(r.Z,{key:s.ID,staticClass:"mt-3 p-2 d-flex align-items-center justify-content-between",attrs:{elevation:"5",outlined:"",shaped:""}},[e("div",[t._v(t._s(s.TicketName))]),e("div",{staticClass:"text-success"},[t._v(" "+t._s(t._f("secondsInMinutes")(t.calculateTimestampDifference(s.CreatedAt,s.UpdatedAt)))+" ")])])})),e("hr")],2)],1)])],1)])],1)])])])},p=[],g=(s(7658),s(6154)),f=function(){var t=this,e=t._self._c;return e("div",{class:t.time<=60?"text-success":"text-danger"},[t._v(t._s(t._f("secondsInMinutes")(t.time)))])},v=[],C=s(381),w=s.n(C),_={name:"stopwatch",props:{running:{type:Boolean,default:!1},resetWhenStart:{type:Boolean,default:!1},restWhenStop:{type:Boolean,default:!1},starter:{type:Number,default:600}},watch:{running:function(t,e){t?this.startT():this.stopT()}},mounted(){this.running&&this.startT()},data(){return{time:0,timer:null}},methods:{stopT:function(){clearInterval(this.timer),this.restWhenStop&&this.resetT()},startT:function(){this.resetWhenStart&&this.resetT(),this.starter&&(this.time=this.starter),this.timer=setInterval((()=>{this.time++}),1e3)},resetT:function(){this.time=0}},filters:{secondsInMinutes:function(t){return w()("2015-01-01").startOf("day").seconds(t).format("HH:mm:ss")}}},T=_,k=s(1001),S=(0,k.Z)(T,f,v,!1,null,"55961d23",null),x=S.exports,b={components:{Stopwatch:x},filters:{secondsInMinutes:function(t){return w()("2015-01-01").startOf("day").seconds(t).format("HH:mm:ss")}},data(){return{noShow:[],finished:[],waiting:[],lastcalled:null,present:!1,users:[],user:null,counters:[],disableNext:!1,socket:null,serverIp:null,startTimer:!1}},methods:{convertDateToCustomFormat(t){const e=w()(t).format("YYYY-MM-DDTHH:mm:ss[Z]");return e},convertDateToIndianTimestampFormat(t){t.setUTCHours(t.getUTCHours()+5),t.setUTCMinutes(t.getUTCMinutes()+30);const e=t.toISOString().replace("Z","+05:30");return e},calculateTimestampDifference(t,e){const s=new Date(t),a=new Date(e),i=a-s,r=i/1e3;return r},getnextticket(){let t={id:"",company_code:this.$store.state.Auth.user.company_code,branch_code:this.$store.state.Auth.user.company_code};g.Z.post("/ticket/gettickettoprocess",t).then((t=>{console.log("res:::::",t),t.data.CounterID=this.$store.state.Auth.activeCounter.ID,t.data.StartedServingAt=this.convertDateToCustomFormat(this.convertDateToIndianTimestampFormat(new Date)),this.$store.commit("SET_ACTIVE_TICKET",t.data),this.startTimer=!0,this.updatestartTime(),this.updateLastTicketStatus("STARTED"),this.sendMessage(t.data,"next"),this.reUpdate()})).catch((t=>{console.log(t.response.data),this.$toast.error("error occured while getting ticket!!!")}))},getlastongoingticket(){g.Z.get(`/ticket/getlaststarted/${this.$store.state.Auth.counterUser.ID}`).then((t=>{console.log("res:::::",t),this.present=!0,this.startTimer=!0,this.$store.commit("SET_ACTIVE_TICKET",t.data)})).catch((t=>{this.present=!1,console.log("error getting error",t.response.data),this.$toast.error("error occured while getting ticket!!!")}))},updateLastTicketStatus(t){let e={ticket_status:t,updated_by:this.$store.state.Auth.counterUser.ID,id:this.$store.state.Auth.activeTicket.ID};g.Z.post("/ticket/updateticketstatus",e).then((e=>{console.log("res:::::",e),this.disableNext&&(this.disableNext=!1),console.log("Status",t),"NO_SHOW"!==t&&"FINISHED"!==t||(this.sendMessage(this.$store.state.Auth.activeTicket,"finish"),this.startTimer=!1,this.reUpdate(),this.updateEndTime(),this.$store.commit("SET_ACTIVE_TICKET",{}))})).catch((t=>{console.log(t.response),this.$toast.error("error occured while updating last ticket!!!")}))},updatestartTime(){let t={updated_by:this.$store.state.Auth.counterUser.ID,id:this.$store.state.Auth.activeTicket.ID,counterId:this.$store.state.Auth.activeCounter.ID};g.Z.post("/ticket/updatetickettime",t).then((t=>{console.log("res:::::",t)})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting noshow ticket!!!")}))},updateEndTime(){let t={updated_by:this.$store.state.Auth.counterUser.ID,id:this.$store.state.Auth.activeTicket.ID};g.Z.post("/ticket/updateendtime",t).then((t=>{console.log("res:::::",t)})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting noshow ticket!!!")}))},getnoshow(){g.Z.get(`/ticket/getnoshow/${this.$store.state.Auth.activeCounter.ID}`).then((t=>{console.log("res:::::",t),t.data?this.noShow=t.data:this.noShow=[]})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting noshow ticket!!!")}))},getwaiting(){g.Z.get("/ticket/getwaiting").then((t=>{console.log("res:::::",t),t.data?this.waiting=t.data:this.waiting=[]})).catch((t=>{console.log("error response in this",t.response),this.$toast.error("error occured while getting waiting ticket!!!")}))},getcompleted(){g.Z.get(`/ticket/getfinished/${this.$store.state.Auth.activeCounter.ID}`).then((t=>{console.log("res:::::",t),t.data?this.finished=t.data:this.finished=[]})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting completed ticket!!!")}))},getlastcalled(){g.Z.get("/ticket/getlastcalled").then((t=>{console.log("res:::::",t),this.lastcalled=t.data})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting last ticket!!!")}))},getServerIP(){return new Promise(((t,e)=>{g.Z.get("http://localhost:3000/api/getServerIP").then((e=>{console.log("res serverip:::::",e),this.serverIp=e.data.IP,t(e.data)})).catch((t=>{e(t),console.log(t.response),this.$toast.error("error occured while getting last ticket!!!")}))}))},getAllUser(){let t={company_code:this.$store.state.Auth.user.company_code,branch_code:""};g.Z.post("/user/getAlluser",t).then((t=>{console.log("res:::::",t),t.data.message.forEach((t=>{let e={};e.email=t.Email,e.name=t.Firstname+" "+t.Lastname,e.branch=t.CompanyCode,e.id=t.ID,this.users.push(e)}))})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting all user!!!")}))},getAllCounters(){g.Z.get(`/counter/getAllcounter/${this.$store.getters.getUser.company_code}`).then((t=>{console.log(">>>>>>>>>>>>>>>>>",t),t.data.message.forEach((t=>{let e={};e.counterNumber=t.CounterNumber,e.counterName=t.CounterName,e.branchCode=t.BranchCode,e.branchName=t.BranchName,e.date=t.CreatedAt,e.id=t.ID,this.counters.push(e)})),this.$toast.success("counters fetched successfully.")})).catch((t=>{console.log(t.response),this.$toast.error("error occured while getting counters!!!")}))},connectToServer(){this.socket.onclose=t=>{console.log("WebSocket connection closed:",t)},this.socket.onopen=t=>{console.log("WebSocket connection opened:",t)},this.socket.onerror=t=>{console.log("WebSocket connection error:",t)}},sendMessage(t,e){if(this.socket.readyState===WebSocket.OPEN){let s={ip:"",ticket_payload:t,action:e};this.socket.send(JSON.stringify(s)),console.log("Sent message to server:",t)}},reUpdate(){this.getwaiting(),this.getcompleted(),this.getlastcalled(),this.getnoshow()}},beforeDestroy(){this.socket&&(this.socket.send("disconnect"),this.socket.close())},mounted(){this.getlastongoingticket(),this.reUpdate(),this.getAllUser(),this.getAllCounters()},created(){this.getServerIP().then((t=>{this.socket=new WebSocket(`ws://${t.IP}:8090/ws`),this.connectToServer()}))}},y=b,D=(0,k.Z)(y,m,p,!1,null,"45a3ca84",null),Z=D.exports},1884:function(){},266:function(t,e,s){s(7658),s(1884);var a=s(144),i=s(1767),r=s(5352);const o=["sm","md","lg","xl"],n=(()=>o.reduce(((t,e)=>(t[e]={type:[Boolean,String,Number],default:!1},t)),{}))(),c=(()=>o.reduce(((t,e)=>(t["offset"+(0,r.jC)(e)]={type:[String,Number],default:null},t)),{}))(),l=(()=>o.reduce(((t,e)=>(t["order"+(0,r.jC)(e)]={type:[String,Number],default:null},t)),{}))(),d={col:Object.keys(n),offset:Object.keys(c),order:Object.keys(l)};function h(t,e,s){let a=t;if(null!=s&&!1!==s){if(e){const s=e.replace(t,"");a+=`-${s}`}return"col"!==t||""!==s&&!0!==s?(a+=`-${s}`,a.toLowerCase()):a.toLowerCase()}}const u=new Map;e.Z=a["default"].extend({name:"v-col",functional:!0,props:{cols:{type:[Boolean,String,Number],default:!1},...n,offset:{type:[String,Number],default:null},...c,order:{type:[String,Number],default:null},...l,alignSelf:{type:String,default:null,validator:t=>["auto","start","end","center","baseline","stretch"].includes(t)},tag:{type:String,default:"div"}},render(t,{props:e,data:s,children:a,parent:r}){let o="";for(const i in e)o+=String(e[i]);let n=u.get(o);if(!n){let t;for(t in n=[],d)d[t].forEach((s=>{const a=e[s],i=h(t,s,a);i&&n.push(i)}));const s=n.some((t=>t.startsWith("col-")));n.push({col:!s||!e.cols,[`col-${e.cols}`]:e.cols,[`offset-${e.offset}`]:e.offset,[`order-${e.order}`]:e.order,[`align-self-${e.alignSelf}`]:e.alignSelf}),u.set(o,n)}return t(e.tag,(0,i.ZP)(s,{class:n}),a)}})}}]);
//# sourceMappingURL=462.7cc78e6c.js.map